## Description
Implements Issue #20 (continuation of Issue #3) by enhancing ingestion reliability and UX while preserving schema and views.

Key features:
- Fallback levels (ad → adset → campaign) when a level returns no rows.
- Multi-level ingestion in a single run via `--levels` (e.g., `ad,adset,campaign`).
- Chunking for long ranges: if total range > 60 days, chunk into 30-day windows (configurable via `--chunk-days`).
- Date presets include `lifetime` using Meta’s native preset. If `--date-preset` is provided with explicit `--since/--until`, we warn and prefer the explicit dates.
- Tenant default level via `configs/tenants.yaml` (`default_level`), respected if `--levels`/`--level` not provided.
- BigQuery MERGE-based dedup to avoid duplicates and allow idempotent re-runs.
- Implemented `MetaAdapter.fetch_insights` using Meta Graph API with daily breakdown and pagination.

Fixes #20.

## Type of change
- [x] New feature (non-breaking change which adds functionality)
- [x] Documentation update

## How Has This Been Tested?
- Unit tests
  - Updated CLI tests for date precedence (warn + prefer explicit dates) and defaults.
- Integration tests (gated via `PSN_INTEGRATION=1`)
  - `tests/integration/test_meta_e2e.py` exercises end-to-end flow against Meta and BigQuery for Fleming using window 2025-04-29..2025-05-31. It asserts:
    - CLI returns successfully and reports `Loaded N rows...` with `N > 0`.
    - BigQuery contains rows for that account and date range (validated via `bq query`).
  - Requires environment variables:
    - `PSN_INTEGRATION=1`
    - `META_ACCESS_TOKEN` (Meta Graph API token)
    - `META_ACCOUNT_ID` (e.g., `act_1234567890`)
    - GCP credentials available for BigQuery.

## Implementation details
- CLI (`paid_social_nav/cli/main.py`)
  - Added: `--levels`, `--fallback-levels/--no-fallback-levels`, `--chunk-days`, `--retries`, `--retry-backoff-seconds`, `--rate-limit-rps`.
  - Date precedence: allow both preset and since/until; warn and zero out preset.
  - Respects tenant default level from YAML when flags are not provided.
- Core sync (`paid_social_nav/core/sync.py`)
  - Orchestrates multi-level and fallback. Implements chunking (>60d → 30d windows by default).
  - Supports `lifetime` by passing the preset directly to the adapter (no explicit date range).
  - Simple rate limiting and retry/backoff around page fetches.
  - Tracks and returns loaded row counts across chunks/levels (note: MERGE may update existing rows; count reflects rows attempted to load per chunk).
- BigQuery (`paid_social_nav/storage/bq.py`)
  - `INSIGHTS_TABLE = fct_ad_insights_daily`.
  - Ensures dataset/table exist. Loads to staging (`__stg_fct_ad_insights_daily`) and MERGEs into destination on composite key:
    - (date, level, account_global_id, campaign_global_id, adset_global_id, ad_global_id)
  - WHEN MATCHED UPDATE metrics; WHEN NOT MATCHED INSERT.
- Meta adapter (`paid_social_nav/adapters/meta/adapter.py`)
  - Uses Graph API v18 with fields: date_start, date_stop, impressions, clicks, spend, ctr, frequency, ad_id, adset_id, campaign_id, actions.
  - Supports both explicit `time_range` and `date_preset` (including lifetime), daily breakdown via `time_increment=1`, pagination via `paging.next`.
  - Emits `InsightRecord` for each daily row.
- Tenant config (`configs/tenants.yaml`, `paid_social_nav/core/tenants.py`)
  - YAML-backed resolver with `default_level` support. Seeded with `fleming` tenant.
- Secrets (`paid_social_nav/storage/secrets.py`)
  - Lazy import of Secret Manager client to avoid hard dependency during unit tests.
- Docs
  - README updated with new flags, date precedence behavior, lifetime preset examples, multi-level usage, chunking, and tenant defaults.

## Manual test commands
- Install dependencies & hooks
  - python -m venv .venv && source .venv/bin/activate
  - pip install -e ".[dev,test]"
  - pre-commit install
- Lint/format/tests
  - make precommit
  - make test
- Example ingestion (Fleming)
  - export META_ACCESS_TOKEN={{META_ACCESS_TOKEN}}
  - psn meta sync-insights \
      --account-id {{META_ACCOUNT_ID}} \
      --level ad \
      --since 2025-04-29 --until 2025-05-31 \
      --tenant fleming

## Expected outcomes
- Successful CLI run prints: "Loaded N rows into fleming-424413.paid_social.fct_ad_insights_daily" with N > 0 for the Fleming window (2025-04-29..2025-05-31).
- Rows appear in BigQuery with appropriate `level` and global_id fields populated per level.
- Re-running the same sync is idempotent (MERGE dedup prevents duplicates; existing rows update).

## Checklist
- [x] Code follows project style guidelines (Ruff, format)
- [x] Self-review completed
- [x] Documentation updated (README)
- [x] Tests added/updated; unit tests pass locally
- [x] Integration test scaffolded (gated via PSN_INTEGRATION=1) and validated locally where credentials available

